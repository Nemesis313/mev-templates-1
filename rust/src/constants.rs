use ethers::{
    prelude::Lazy,
    types::{Address, Bytes, H160, U256, U64},
};
use std::str::FromStr;

pub static WEI: Lazy<U256> = Lazy::new(|| U256::from(10).pow(U256::from(18)));
pub static GWEI: Lazy<U256> = Lazy::new(|| U256::from(10).pow(U256::from(9)));

pub static ZERO_ADDRESS: Lazy<Address> =
    Lazy::new(|| Address::from_str("0x0000000000000000000000000000000000000000").unwrap());

pub fn get_env(key: &str) -> String {
    std::env::var(key).unwrap()
}

#[derive(Debug, Clone)]
pub struct Env {
    pub https_url: String,
    pub wss_url: String,
    pub chain_id: U64,
    pub private_key: String,
    pub signing_key: String,
    pub bot_address: String,
}

impl Env {
    pub fn new() -> Self {
        Env {
            https_url: get_env("HTTPS_URL"),
            wss_url: get_env("WSS_URL"),
            chain_id: U64::from_str(&get_env("CHAIN_ID")).unwrap(),
            private_key: get_env("PRIVATE_KEY"),
            signing_key: get_env("SIGNING_KEY"),
            bot_address: get_env("BOT_ADDRESS"),
        }
    }
}

pub fn get_blacklist_tokens() -> Vec<H160> {
    // Polygon: 0x9469603F3Efbcf17e4A5868d81C701BDbD222555
    vec![]
        .into_iter()
        .map(|addr| H160::from_str(addr).unwrap())
        .collect()
}

pub static BOT_CODE: Lazy<Bytes> = Lazy::new(|| {
    "0x60806040526004361061004e5760003560e01c806310d1e85c146102ed578063315bccd61461030d5780638da5cb5b14610349578063a7042d7e14610369578063f04f2707146103a6576100b9565b366100b957600160009054906101000a90046001600160a01b03166001600160a01b031663d0e30db0346040518263ffffffff1660e01b81526004016000604051808303818588803b1580156100a357600080fd5b505af11580156100b7573d6000803e3d6000fd5b005b60003560203560403581156102ad5760803560018390036101b55760408051600180825281830190925260009160208083019080368337019050509050818160008151811061010a5761010a610a1b565b6001600160a01b039290921660209283029190910190910152604080516001808252818301909252600091816020016020820280368337019050509050858160008151811061015b5761015b610a1b565b6020908102919091010152604051632e1c224f60e11b81526001600160a01b03851690635c38449e9061019b903090869086906000903690600401610a5a565b600060405180830381600087803b1580156100a357600080fd5b826002036100b75760008290506000816001600160a01b0316630dfe16816040518163ffffffff1660e01b81526004016020604051808303816000875af1158015610204573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102289190610b1b565b9050806001600160a01b0316836001600160a01b0316036102785760405163022c0d9f60e01b81526001600160a01b0383169063022c0d9f9061019b908990600090309082903690600401610b3f565b60405163022c0d9f60e01b81526001600160a01b0383169063022c0d9f9061019b906000908a90309083903690600401610b3f565b6100b76000368080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152506103c692505050565b3480156102f957600080fd5b506100b7610308366004610c0e565b61066a565b34801561031957600080fd5b5060015461032d906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b34801561035557600080fd5b5060005461032d906001600160a01b031681565b34801561037557600080fd5b506100b7610384366004610c71565b600180546001600160a01b0319166001600160a01b0392909216919091179055565b3480156103b257600080fd5b506100b76103c1366004610d1d565b6107d7565b8051602082015190606090046000190160005b8160ff168160ff16101561066357606081028401608081015160a082015160c09092015160405163a9059cbb60e01b81526001600160a01b038084166004830152602482018890529293928491849182169063a9059cbb906044016020604051808303816000875af1158015610453573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104779190610e1c565b50600080600080856001600160a01b0316630902f1ac6040518163ffffffff1660e01b81526004016060604051808303816000875af11580156104be573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104e29190610e5a565b506001600160701b031691506001600160701b03169150866001600160a01b0316886001600160a01b0316101561051e57819350809250610525565b8093508192505b50506040516370a0823160e01b81526001600160a01b03888116600483015260009184918616906370a0823190602401602060405180830381865afa158015610572573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105969190610eaa565b6105a09190610ed9565b90506105ad8184846108e5565b9a50600080876001600160a01b0316896001600160a01b0316106105d3578c60006105d7565b60008d5b6040805160008152602081019182905263022c0d9f60e01b90915291935091506001600160a01b0388169063022c0d9f9061061b9085908590309060248101610ef0565b600060405180830381600087803b15801561063557600080fd5b505af1158015610649573d6000803e3d6000fd5b50506001909c019b506103d99a5050505050505050505050565b5050919050565b606081015160a0820151336001600160a01b038316146106c05760405162461bcd60e51b815260206004820152600c60248201526b1b9bdd081b1bd85b941bdbdb60a21b60448201526064015b60405180910390fd5b6001600160a01b03861630146107055760405162461bcd60e51b815260206004820152600a6024820152693737ba1039b2b73232b960b11b60448201526064016106b7565b61070e836103c6565b506000851561071d578561071f565b845b905060006103e5610731836003610f63565b61073b9190610f82565b610746906001610fa4565b905060006107548284610fa4565b60405163a9059cbb60e01b81526001600160a01b038781166004830152602482018390529192509085169063a9059cbb906044016020604051808303816000875af11580156107a7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107cb9190610e1c565b50505050505050505050565b6060810151336001600160a01b038216146108205760405162461bcd60e51b81526020600482015260096024820152681b9bdd081d985d5b1d60ba1b60448201526064016106b7565b60008560008151811061083557610835610a1b565b6020026020010151905060008560008151811061085457610854610a1b565b60200260200101519050610867846103c6565b5060405163a9059cbb60e01b81526001600160a01b0384811660048301526024820183905283169063a9059cbb906044016020604051808303816000875af11580156108b7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108db9190610e1c565b5050505050505050565b600080841161094a5760405162461bcd60e51b815260206004820152602b60248201527f556e697377617056324c6962726172793a20494e53554646494349454e545f4960448201526a1394155517d05353d5539560aa1b60648201526084016106b7565b60008311801561095a5750600082115b6109b75760405162461bcd60e51b815260206004820152602860248201527f556e697377617056324c6962726172793a20494e53554646494349454e545f4c604482015267495155494449545960c01b60648201526084016106b7565b60006109c5856103e5610f63565b905060006109d38483610f63565b90506000826109e4876103e8610f63565b6109ee9190610fa4565b90506109fa8183610f82565b979650505050505050565b634e487b7160e01b600052604160045260246000fd5b634e487b7160e01b600052603260045260246000fd5b81835281816020850137506000828201602090810191909152601f909101601f19169091010190565b6001600160a01b0386811682526080602080840182905287519184018290526000928882019290919060a0860190855b81811015610aa8578551851683529483019491830191600101610a8a565b5050858103604087015288518082529082019350915080880160005b83811015610ae057815185529382019390820190600101610ac4565b505050508281036060840152610af7818587610a31565b98975050505050505050565b6001600160a01b0381168114610b1857600080fd5b50565b600060208284031215610b2d57600080fd5b8151610b3881610b03565b9392505050565b85815284602082015260018060a01b03841660408201526080606082015260006109fa608083018486610a31565b604051601f8201601f1916810167ffffffffffffffff81118282101715610b9657610b96610a05565b604052919050565b600082601f830112610baf57600080fd5b813567ffffffffffffffff811115610bc957610bc9610a05565b610bdc601f8201601f1916602001610b6d565b818152846020838601011115610bf157600080fd5b816020850160208301376000918101602001919091529392505050565b60008060008060808587031215610c2457600080fd5b8435610c2f81610b03565b93506020850135925060408501359150606085013567ffffffffffffffff811115610c5957600080fd5b610c6587828801610b9e565b91505092959194509250565b600060208284031215610c8357600080fd5b8135610b3881610b03565b600067ffffffffffffffff821115610ca857610ca8610a05565b5060051b60200190565b600082601f830112610cc357600080fd5b81356020610cd8610cd383610c8e565b610b6d565b82815260059290921b84018101918181019086841115610cf757600080fd5b8286015b84811015610d125780358352918301918301610cfb565b509695505050505050565b60008060008060808587031215610d3357600080fd5b843567ffffffffffffffff80821115610d4b57600080fd5b818701915087601f830112610d5f57600080fd5b81356020610d6f610cd383610c8e565b82815260059290921b8401810191818101908b841115610d8e57600080fd5b948201945b83861015610db5578535610da681610b03565b82529482019490820190610d93565b98505088013592505080821115610dcb57600080fd5b610dd788838901610cb2565b94506040870135915080821115610ded57600080fd5b610df988838901610cb2565b93506060870135915080821115610e0f57600080fd5b50610c6587828801610b9e565b600060208284031215610e2e57600080fd5b81518015158114610b3857600080fd5b80516001600160701b0381168114610e5557600080fd5b919050565b600080600060608486031215610e6f57600080fd5b610e7884610e3e565b9250610e8660208501610e3e565b9150604084015163ffffffff81168114610e9f57600080fd5b809150509250925092565b600060208284031215610ebc57600080fd5b5051919050565b634e487b7160e01b600052601160045260246000fd5b600082821015610eeb57610eeb610ec3565b500390565b84815260006020858184015260018060a01b038516604084015260806060840152835180608085015260005b81811015610f385785810183015185820160a001528201610f1c565b81811115610f4a57600060a083870101525b50601f01601f19169290920160a0019695505050505050565b6000816000190483118215151615610f7d57610f7d610ec3565b500290565b600082610f9f57634e487b7160e01b600052601260045260246000fd5b500490565b60008219821115610fb757610fb7610ec3565b50019056fea2646970667358221220b5415a8b00117b6f8547528d2b45a5569925dc3c0ed6bc43d0e96fa0714e041264736f6c634300080d0033"
        .parse()
        .unwrap()
});

pub static SWAP_SIMULATOR_CODE: Lazy<Bytes> = Lazy::new(|| {
    "0x608060405234801561001057600080fd5b506004361061002b5760003560e01c806381eeb93c14610030575b600080fd5b61004361003e366004610463565b61005c565b6040805192835260208301919091520160405180910390f35b60405163a9059cbb60e01b81526001600160a01b03848116600483015260248201869052600091829185169063a9059cbb906044016020604051808303816000875af11580156100b0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906100d491906104b0565b50600080600080886001600160a01b0316630902f1ac6040518163ffffffff1660e01b81526004016060604051808303816000875af115801561011b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061013f91906104f0565b506001600160701b031691506001600160701b03169150866001600160a01b0316886001600160a01b0316101561017b57819350809250610182565b8093508192505b50506040516370a0823160e01b81526001600160a01b03888116600483015260009184918916906370a0823190602401602060405180830381865afa1580156101cf573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101f39190610540565b6101fd919061056f565b905061020a818484610322565b9450600080876001600160a01b0316896001600160a01b03161061023057866000610234565b6000875b6040805160008152602081019182905263022c0d9f60e01b90915291935091506001600160a01b038b169063022c0d9f906102789085908590309060248101610586565b600060405180830381600087803b15801561029257600080fd5b505af11580156102a6573d6000803e3d6000fd5b50506040516370a0823160e01b81523060048201526001600160a01b038b1692506370a082319150602401602060405180830381865afa1580156102ee573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103129190610540565b9550505050505094509492505050565b600080841161038c5760405162461bcd60e51b815260206004820152602b60248201527f556e697377617056324c6962726172793a20494e53554646494349454e545f4960448201526a1394155517d05353d5539560aa1b60648201526084015b60405180910390fd5b60008311801561039c5750600082115b6103f95760405162461bcd60e51b815260206004820152602860248201527f556e697377617056324c6962726172793a20494e53554646494349454e545f4c604482015267495155494449545960c01b6064820152608401610383565b6000610407856103e56105f9565b9050600061041584836105f9565b9050600082610426876103e86105f9565b6104309190610618565b905061043c8183610630565b979650505050505050565b80356001600160a01b038116811461045e57600080fd5b919050565b6000806000806080858703121561047957600080fd5b8435935061048960208601610447565b925061049760408601610447565b91506104a560608601610447565b905092959194509250565b6000602082840312156104c257600080fd5b815180151581146104d257600080fd5b9392505050565b80516001600160701b038116811461045e57600080fd5b60008060006060848603121561050557600080fd5b61050e846104d9565b925061051c602085016104d9565b9150604084015163ffffffff8116811461053557600080fd5b809150509250925092565b60006020828403121561055257600080fd5b5051919050565b634e487b7160e01b600052601160045260246000fd5b60008282101561058157610581610559565b500390565b84815260006020858184015260018060a01b038516604084015260806060840152835180608085015260005b818110156105ce5785810183015185820160a0015282016105b2565b818111156105e057600060a083870101525b50601f01601f19169290920160a0019695505050505050565b600081600019048311821515161561061357610613610559565b500290565b6000821982111561062b5761062b610559565b500190565b60008261064d57634e487b7160e01b600052601260045260246000fd5b50049056fea2646970667358221220e8823527f974ffd57a7164178abf1c588f54721b4367fade67de0ef6ccb7674164736f6c634300080d0033"
        .parse()
        .unwrap()
});

// Use later for broadcasting to multiple builders
// static BUILDER_URLS: &[&str] = &[
//     "https://builder0x69.io",
//     "https://rpc.beaverbuild.org",
//     "https://relay.flashbots.net",
//     "https://rsync-builder.xyz",
//     "https://rpc.titanbuilder.xyz",
//     "https://api.blocknative.com/v1/auction",
//     "https://mev.api.blxrbdn.com",
//     "https://eth-builder.com",
//     "https://builder.gmbit.co/rpc",
//     "https://buildai.net",
//     "https://rpc.payload.de",
//     "https://rpc.lightspeedbuilder.info",
//     "https://rpc.nfactorial.xyz",
// ];
